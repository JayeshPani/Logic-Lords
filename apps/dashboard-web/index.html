<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>InfraGuard Control Room</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/dashboard-static/styles.css" />
    <script type="module" src="/dashboard-static/main.js"></script>
    <script src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"></script>
  </head>
  <body class="bg-grid custom-scrollbar">
    <div class="app-shell">
      <aside class="sidebar" aria-label="Primary Navigation">
        <div class="brand-wrap">
          <div class="brand-icon glow-blue">
            <iconify-icon icon="lucide:shield-check"></iconify-icon>
          </div>
          <h1 class="brand-title">InfraGuard</h1>
        </div>

        <nav class="side-nav" role="tablist" aria-label="Section Tabs">
          <button class="nav-item tab-trigger nav-item-active" type="button" data-tab-target="overview" aria-selected="true">
            <iconify-icon icon="lucide:layout-dashboard"></iconify-icon>
            <span>Overview</span>
          </button>
          <button class="nav-item tab-trigger" type="button" data-tab-target="triage" aria-selected="false">
            <iconify-icon icon="lucide:siren"></iconify-icon>
            <span>Triage</span>
          </button>
          <button class="nav-item tab-trigger" type="button" data-tab-target="asset" aria-selected="false">
            <iconify-icon icon="lucide:activity"></iconify-icon>
            <span>Asset Detail</span>
          </button>
          <button class="nav-item tab-trigger" type="button" data-tab-target="ledger" aria-selected="false">
            <iconify-icon icon="lucide:database-zap"></iconify-icon>
            <span>Ledger</span>
          </button>
          <button class="nav-item tab-trigger" type="button" data-tab-target="map" aria-selected="false">
            <iconify-icon icon="lucide:map-pinned"></iconify-icon>
            <span>City Map</span>
          </button>
          <button class="nav-item tab-trigger" type="button" data-tab-target="maintenance" aria-selected="false">
            <iconify-icon icon="lucide:clipboard-list"></iconify-icon>
            <span>Maintenance</span>
          </button>
        </nav>

        <div class="legend-panel card-gradient">
          <p class="legend-title">Severity Legend</p>
          <div class="legend-row"><span class="legend-dot risk-low"></span> Healthy</div>
          <div class="legend-row"><span class="legend-dot risk-watch"></span> Watch</div>
          <div class="legend-row"><span class="legend-dot risk-high"></span> Warning</div>
          <div class="legend-row"><span class="legend-dot risk-critical"></span> Critical</div>
        </div>
      </aside>

      <main class="main-area" id="main-content">
        <header class="top-header">
          <div class="header-left">
            <div class="command-center">
              <span class="label">Command Center:</span>
              <span class="value" id="command-center-value">METRO-NORTH_UNIT_04</span>
            </div>
            <div class="weather-pill" aria-label="Weather Snapshot">
              <div class="weather-item">
                <iconify-icon icon="lucide:cloud-rain"></iconify-icon>
                <span class="mono" id="weather-temp">24C / HUM 62%</span>
              </div>
              <div class="divider"></div>
              <div class="weather-item">
                <iconify-icon icon="lucide:wind"></iconify-icon>
                <span class="mono" id="weather-wind">12KM/H NW</span>
              </div>
            </div>
          </div>

          <div class="header-right">
            <div class="clock-wrap">
              <div class="mono date" id="clock-date">-</div>
              <div class="mono time" id="clock-time">-</div>
            </div>
            <button id="profile-btn" class="profile-btn avatar-ring" type="button" aria-label="Open account" aria-expanded="false" aria-controls="account-modal">
              <img
                src="https://api.dicebear.com/7.x/avataaars/svg?seed=Admin"
                alt="Admin profile"
                class="avatar"
              />
            </button>

          </div>
        </header>

        <p id="stale-badge" class="stale-badge" aria-live="polite"></p>

        <div class="tab-panels">
          <section class="tab-panel tab-panel-active" id="tab-overview" data-tab-panel="overview" aria-label="Overview">
            <section class="ops-kpi-grid" id="ops-kpi-grid" aria-label="Operational KPIs">
              <article class="kpi-card card-gradient">
                <p class="kpi-label">Overall Health</p>
                <p class="kpi-value mono" id="kpi-overall-health-value">-</p>
                <p class="kpi-foot">Average infrastructure health score</p>
              </article>
              <article class="kpi-card card-gradient">
                <p class="kpi-label">Critical Assets</p>
                <p class="kpi-value mono danger" id="kpi-critical-assets-value">-</p>
                <p class="kpi-foot">Immediate escalation required</p>
              </article>
              <article class="kpi-card card-gradient">
                <p class="kpi-label">72h System Failure Risk</p>
                <p class="kpi-value mono" id="kpi-system-risk-value">-</p>
                <p class="kpi-foot">Highest projected risk across city</p>
              </article>
              <article class="kpi-card card-gradient">
                <p class="kpi-label">Ledger Reachability</p>
                <p class="kpi-value mono" id="kpi-ledger-reachability-value">DISCONNECTED</p>
                <p class="kpi-foot">Sepolia chain status from gateway</p>
              </article>
            </section>

            <section class="status-bar card-gradient">
              <div class="status-item">
                <p class="status-label">Data Source</p>
                <p class="status-value" id="status-data-source">-</p>
              </div>
              <div class="status-item">
                <p class="status-label">Tracked Assets</p>
                <p class="status-value mono" id="status-asset-count">0</p>
              </div>
              <div class="status-item">
                <p class="status-label">Critical Assets</p>
                <p class="status-value mono danger" id="status-critical-count">0</p>
              </div>
              <div class="status-item">
                <p class="status-label">Last Sync</p>
                <p class="status-value mono" id="status-sync-time">-</p>
              </div>
            </section>
          </section>

          <section class="tab-panel" id="tab-triage" data-tab-panel="triage" aria-label="Priority Triage" hidden>
            <section class="panel triage-panel card-gradient" id="alerts-panel" aria-label="Priority Triage Queue">
              <div class="panel-head-row">
                <h2>Priority Triage Queue</h2>
                <p class="panel-subtitle">Ranked by 72h failure probability, then severity</p>
              </div>
              <div class="triage-columns mono">
                <span>Rank</span>
                <span>Asset</span>
                <span>Zone</span>
                <span>Severity</span>
                <span>Risk</span>
              </div>
              <div id="triage-list" class="triage-list" role="listbox" aria-label="Asset risk ranking"></div>
            </section>
          </section>

          <section class="tab-panel" id="tab-asset" data-tab-panel="asset" aria-label="Selected Asset Detail" hidden>
            <section class="selected-grid" aria-label="Selected Asset Details">
              <article class="panel selected-summary card-gradient">
                <div class="panel-head-row">
                  <div>
                    <h2 id="selected-asset-title">-</h2>
                    <p class="panel-subtitle mono" id="selected-asset-meta">-</p>
                  </div>
                  <span class="severity-chip" id="selected-asset-severity">Stable</span>
                </div>
                <div class="summary-strip">
                  <div class="summary-item">
                    <span class="summary-label">Selected Asset Health</span>
                    <span class="summary-value mono" id="selected-asset-health">-</span>
                  </div>
                  <div class="summary-item">
                    <span class="summary-label">Forecast Horizon</span>
                    <span class="summary-value mono">72h</span>
                  </div>
                </div>

                <div class="sensor-grid" id="bridges-panel">
                  <article class="sensor-card">
                    <div class="sensor-head">
                      <div>
                        <p class="sensor-title">Bridge Strain</p>
                        <h4 class="sensor-value mono" id="strain-value">-</h4>
                      </div>
                      <div class="sensor-icon cyan"><iconify-icon icon="lucide:activity"></iconify-icon></div>
                    </div>
                    <div class="micro-bars" id="strain-bars"></div>
                    <div class="sensor-foot"><span>Trend</span><span id="strain-delta">-</span></div>
                  </article>

                  <article class="sensor-card">
                    <div class="sensor-head">
                      <div>
                        <p class="sensor-title">Vibration</p>
                        <h4 class="sensor-value mono" id="vibration-value">-</h4>
                      </div>
                      <div class="sensor-icon green"><iconify-icon icon="lucide:waveform"></iconify-icon></div>
                    </div>
                    <div class="micro-bars" id="vibration-bars"></div>
                    <div class="sensor-foot"><span>Trend</span><span id="vibration-delta">-</span></div>
                  </article>

                  <article class="sensor-card">
                    <div class="sensor-head">
                      <div>
                        <p class="sensor-title">Thermal Stress</p>
                        <h4 class="sensor-value mono" id="temperature-value">-</h4>
                      </div>
                      <div class="sensor-icon orange"><iconify-icon icon="lucide:thermometer"></iconify-icon></div>
                    </div>
                    <div class="micro-bars" id="temperature-bars"></div>
                    <div class="sensor-foot"><span>Heat Alert</span><span id="temperature-delta">-</span></div>
                  </article>

                  <article class="sensor-card">
                    <div class="sensor-head">
                      <div>
                        <p class="sensor-title">Tilt</p>
                        <h4 class="sensor-value mono" id="tilt-value">-</h4>
                      </div>
                      <div class="sensor-icon blue"><iconify-icon icon="lucide:move-3d"></iconify-icon></div>
                    </div>
                    <div class="micro-bars" id="tilt-bars"></div>
                    <div class="sensor-foot"><span>Alignment</span><span id="tilt-delta">-</span></div>
                  </article>
                </div>
              </article>

              <article class="panel gauge-panel card-gradient">
                <h3>Infrastructure Health</h3>
                <div class="gauge-wrap">
                  <svg viewBox="0 0 220 220" class="gauge-svg" aria-label="Infrastructure health gauge">
                    <defs>
                      <linearGradient id="healthGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#00d4ff" />
                        <stop offset="100%" stop-color="#00ff88" />
                      </linearGradient>
                    </defs>
                    <circle class="gauge-bg" cx="110" cy="110" r="86"></circle>
                    <circle class="gauge-value" id="health-gauge-ring" cx="110" cy="110" r="86"></circle>
                  </svg>
                  <div class="gauge-center">
                    <div class="mono score" id="health-score">0.00</div>
                    <div class="badge" id="health-status-badge">Unknown</div>
                    <div class="mono sub" id="failure-probability">72h Failure: -</div>
                  </div>
                </div>
              </article>

              <article class="panel components-panel card-gradient">
                <h3>Risk Components</h3>
                <p class="panel-subtitle">Length encodes contribution to overall risk</p>
                <div id="selected-asset-components" class="risk-bars"></div>
              </article>
            </section>

            <article class="panel forecast-panel forecast-panel-wide card-gradient">
              <h3>72h Failure Forecast</h3>
              <p class="panel-subtitle">Bands show watch/warning/critical thresholds</p>
              <svg id="selected-asset-forecast" viewBox="0 0 1200 300" aria-label="72-hour failure forecast chart"></svg>
            </article>
          </section>

          <section class="tab-panel" id="tab-ledger" data-tab-panel="ledger" aria-label="Ledger and Wallet" hidden>
            <section class="panel ledger-panel card-gradient" id="ledger-panel">
              <div class="panel-head-row">
                <div>
                  <h3>Ledger and Wallet Actions</h3>
                  <p class="panel-subtitle mono">Sepolia connectivity + operator wallet identity</p>
                </div>
              </div>

              <div class="ledger-grid">
                <div class="ledger-card">
                  <div class="ledger-row"><span>Verification Status</span><span class="mono" id="ledger-status">-</span></div>
                  <div class="ledger-row"><span>Sepolia Link</span><span class="mono" id="ledger-connection">DISCONNECTED</span></div>
                  <div class="ledger-row"><span>Latest Block</span><span class="mono" id="ledger-latest-block">-</span></div>
                  <div class="ledger-row"><span>Network</span><span class="mono" id="ledger-network">-</span></div>
                  <div class="ledger-row"><span>Tx Hash</span><span class="mono hash" id="ledger-tx">-</span></div>
                  <div class="ledger-row"><span>Evidence Hash</span><span class="mono hash" id="ledger-evidence">-</span></div>
                  <div class="ledger-row"><span>Wallet Status</span><span class="mono" id="wallet-connection">DISCONNECTED</span></div>
                  <div class="ledger-row"><span>Wallet Address</span><span class="mono hash" id="wallet-address">-</span></div>
                  <div class="ledger-row"><span>Wallet Chain</span><span class="mono" id="wallet-chain">-</span></div>
                </div>

                <div class="ledger-actions sticky-actions">
                  <p id="ledger-connect-message" class="connection-message" aria-live="polite">
                    Click connect to verify live Sepolia reachability.
                  </p>
                  <button id="verify-chain-btn" class="verify-btn" type="button">Connect Sepolia</button>

                  <p id="wallet-connect-message" class="connection-message" aria-live="polite">
                    Click connect wallet to bind operator identity via MetaMask.
                  </p>
                  <button id="connect-wallet-btn" class="verify-btn wallet-btn" type="button">Connect Wallet</button>

                  <ul id="ledger-status-timeline" class="timeline" aria-label="Verification status timeline"></ul>
                </div>
              </div>
            </section>
          </section>

          <section class="tab-panel" id="tab-map" data-tab-panel="map" aria-label="City Risk Map" hidden>
            <article class="panel map-panel card-gradient" id="map-panel">
              <div class="panel-head-row">
                <div>
                  <h3>City Risk Map</h3>
                  <p class="panel-subtitle">Color = severity, size = failure probability</p>
                  <p id="risk-map-status" class="map-status map-status-quiet" aria-live="polite">
                    Open the City Map tab to load live basemap tiles.
                  </p>
                </div>
                <div id="risk-map-legend" class="map-legend" aria-label="Map legend"></div>
              </div>
              <div id="risk-map" class="risk-map" role="img" aria-label="City asset risk map"></div>
            </article>
          </section>

          <section class="tab-panel" id="tab-maintenance" data-tab-panel="maintenance" aria-label="Maintenance Activity" hidden>
            <article class="panel table-panel card-gradient">
              <div class="panel-head-row table-head">
                <h3>Maintenance Activity</h3>
                <p class="panel-subtitle">Most recent actions for selected asset</p>
              </div>
              <div class="table-wrap custom-scrollbar">
                <table>
                  <thead>
                    <tr>
                      <th>Timestamp</th>
                      <th>System Unit</th>
                      <th>Operator</th>
                      <th>Status</th>
                      <th class="align-right">Validation</th>
                    </tr>
                  </thead>
                  <tbody id="maintenance-log-body"></tbody>
                </table>
              </div>
            </article>
          </section>
        </div>
      </main>
    </div>

    <section id="account-modal" class="account-modal" role="dialog" aria-modal="true" aria-labelledby="account-title" hidden>
      <div class="account-modal-backdrop" data-account-close="true"></div>
      <article class="account-card card-gradient">
        <header class="account-head">
          <div>
            <h3 id="account-title">Operator Account</h3>
            <p class="mono account-subtitle">METRO-NORTH_UNIT_04</p>
          </div>
          <button id="account-close-btn" class="icon-btn" type="button" title="Close account panel">
            <iconify-icon icon="lucide:x"></iconify-icon>
          </button>
        </header>

        <div class="account-body">
          <div class="account-row"><span>Name</span><strong>Ops Admin</strong></div>
          <div class="account-row"><span>Role</span><strong>Infrastructure Supervisor</strong></div>
          <div class="account-row"><span>Region</span><strong>Metro North</strong></div>
          <div class="account-row"><span>Wallet Status</span><strong id="account-wallet-status">Unknown</strong></div>
          <div class="account-row"><span>Wallet Address</span><strong class="mono" id="account-wallet-address">-</strong></div>
          <div class="account-row"><span>Wallet Chain</span><strong class="mono" id="account-wallet-chain">-</strong></div>
          <div class="account-row"><span>Sepolia Reachability</span><strong id="account-chain-status">Unknown</strong></div>
        </div>

        <div class="profile-actions">
          <button class="ghost-btn" type="button" data-nav-target="overview">Open Overview</button>
          <button class="ghost-btn" type="button" data-nav-target="ledger">Open Ledger</button>
          <button class="ghost-btn" type="button" data-nav-target="maintenance">Open Maintenance</button>
          <button id="profile-refresh-btn" class="ghost-btn" type="button">Refresh Data</button>
          <button id="profile-disconnect-wallet-btn" class="ghost-btn danger-ghost" type="button">Disconnect Wallet View</button>
        </div>
        <p id="profile-action-note" class="profile-note mono" aria-live="polite"></p>
      </article>
    </section>
  </body>
</html>
